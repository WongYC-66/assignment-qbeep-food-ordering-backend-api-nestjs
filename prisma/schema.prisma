// refer from https://docs.nestjs.com/recipes/prisma
// https://www.prisma.io/docs/orm/prisma-schema/data-model/models

generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id       Int      @id @default(autoincrement())
  username String   @unique
  password String
  role     String
  name     String
  Outlet   Outlet[]
  Order    Order[]
}

model Outlet {
  id       Int     @id @default(autoincrement())
  name     String  @unique
  owner    User    @relation(fields: [owner_id], references: [id])
  owner_id Int
  location String
  Food     Food[]
  Order    Order[]
}

model Food {
  id           Int            @id @default(autoincrement())
  name         String
  description  String
  type         String
  outlet       Outlet         @relation(fields: [outlet_id], references: [id])
  outlet_id    Int
  price        Decimal
  image_url    String
  OrderedItems OrderedItems[]

  @@unique([outlet_id, name]) 
}

model Order {
  id           Int            @id @default(autoincrement())
  user         User           @relation(fields: [user_id], references: [id])
  user_id      Int
  outlet       Outlet         @relation(fields: [outlet_id], references: [id])
  outlet_id    Int
  created_at   DateTime
  note         String
  total_price  Decimal
  OrderedItems OrderedItems[]
}

model OrderedItems {
  id       Int   @id @default(autoincrement())
  order    Order @relation(fields: [order_id], references: [id])
  order_id Int
  food     Food  @relation(fields: [food_id], references: [id])
  food_id  Int
  quantity Int
}
